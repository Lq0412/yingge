# 英歌舞在线试装平台 PRD（MVP）

## 1. 文档信息
- 文档名称：英歌舞在线试装平台 PRD
- 版本：v1.0（MVP）
- 负责人：产品/项目负责人
- 更新时间：2025-12-02
- 适用范围：前端、后端、测试、运营

## 2. 背景与目标
英歌舞服饰造型复杂、线下试穿成本高，线上图文展示又难以感知上身效果。项目目标是提供一套“上传个人照片 + 选择英歌舞服装 = 获取试装效果图”的在线体验，用以验证用户兴趣、收集反馈并为后续与文创/电商合作做准备。

## 3. 目标用户与价值
- 普通用户/爱好者：无需线下准备即可体验英歌舞造型，提升文化传播与互动性。
- 演出队伍/社团：可提前预览造型，辅助排练与视觉设计。
- 商家/运营方：用于推广服饰与配饰，降低退货与沟通成本。

## 4. 使用场景
- 购买/租赁前预览：用户上传清晰半身照，挑选英歌舞服饰款式，快速查看合成效果。
- 主题活动互动：在活动页内提供试装入口，用户生成效果图后可下载或分享。
- 商家展示：商家上传自有款式，生成示例效果图用于宣传。

## 5. 核心目标与成功指标（MVP）
- 试装请求成功率 ≥ 90%（不含外部 AI 服务不可用）。
- 首次试装全流程（注册/登录、上传、生成、查看结果） ≤ 5 分钟。
- 单次 AI 生成延迟：返回结果时间 ≤ 10 秒（或在 UI 中明确进度/占位）。
- 结果可用性：内部评审满意度达成“可上线验证”标准。

## 6. 功能需求
### 6.1 账号与会话
- 支持手机号/邮箱 + 密码注册、登录，完成基础格式校验。
- 登录成功返回会话（JWT 或 Session），用于后续鉴权。
- MVP 仅提供基础资料查看；资料编辑可延后。

### 6.2 个人形象上传
- 支持上传 1 张清晰正面半身人像，格式 jpg/png，单张 ≤ 5MB。
- 上传前端提示拍摄/背景要求；后端校验格式与大小。
- 文件存储在对象存储（如 COS/OSS），数据库仅存 URL 与元数据（归属用户、类型=portrait、创建时间等）。

### 6.3 英歌舞服装素材
- 服装图由运营/商家预置上传（类型=costume），同样存储于对象存储。
- MVP 可先内置若干示例服装；商家上传与分类管理可作为后续迭代。

### 6.4 AI 试装
- 用户在前端选择一张人像图和一张服装图，点击“开始试装”即向后端发起请求。
- 后端校验登录态、图像可用性，调用外部 AI 试装服务（如 Seedream API），传入两张图。
- MVP 采用同步模式；如生成耗时长，前端需展示加载状态并处理失败提示。
- 结果图存储于对象存储（类型=result），数据库记录本次试装（见数据模型）。
- 返回结果 URL 给前端展示；失败时返回明确错误信息并记录日志。

### 6.5 试装记录
- 记录字段：用户 ID、人像图 URL、服装图 URL、结果图 URL、状态（处理中/成功/失败）、错误信息（可选）、创建时间。
- 前端提供“试装记录”列表（按时间倒序）；可查看单条详情（展示三张图与状态）。
- MVP 可暂不提供删除；后续根据合规要求补充。

### 6.6 结果获取与分享
- 支持直接查看与下载结果图；分享链路可延后。
- 结果链接需具备基础防护（带签名或受鉴权控制）。

## 7. 非功能需求
- 性能：单次生成 ≤ 10 秒，列表/详情接口 p95 ≤ 1 秒。
- 可靠性：外部 AI/COS 不可用时需友好降级提示；关键操作记录日志。
- 安全与隐私：密码加密存储；仅登录用户可访问自身图像与记录；用户图片仅用于试装，不得外用。
- 合规：提供隐私声明入口，按需支持图片清除/过期策略。

## 8. 数据与接口概述
- 实体
  - User：id、account、passwordHash、createdAt、role 等。
  - Image：id、userId（可选，服装图可能公共）、type（portrait/costume/result）、url、createdAt、meta。
  - TryOnRecord：id、userId、portraitImageId、costumeImageId、resultImageId、status、errorMsg、createdAt。
- 存储：业务数据存数据库（MySQL 等）；图片统一走对象存储，系统仅保存 URL。
- API：采用 RESTful 设计；具体入参/出参另见接口文档或 Swagger/Knife4j。

## 9. 外部依赖
- 对象存储：COS/OSS，用于存储人像、服装、结果图。
- AI 试装服务：Seedream 或同类 API，需要模型配额与响应时间保障。
- 基础设施：数据库、日志/监控、鉴权方案（JWT/Session）。

## 10. 风险与待决事项
- 模型效果风险：英歌舞服饰细节复杂，需提前验证示例图质量与多样性。
- 文化合规：素材需确保版权与文化表达准确，避免不当合成。
- 隐私合规：需明确图片保存时长与删除能力（后续迭代提供删除/过期清理）。
- 待决：登录方式（短信/邮箱验证码是否引入）、服装库是否对普通用户开放上传、分享链路的权限策略。

## 11. 版本规划
- 当前版本：MVP（单用户试装闭环：注册/登录 → 上传 → 选择服装 → 生成结果 → 查看记录）。
- 后续方向：更多服装分类与标签、批量生成/重试、结果分享与社交、商家后台（素材管理/数据看板）、与电商/活动页的深度接入。
