# 英歌舞在线试装平台 PRD（MVP）

## 1. 文档信息
- 版本：v1.0（MVP）
- 更新时间：2025-12-02
- 适用范围：前端 / 后端 / 测试 / 运营

## 2. 背景与目标
- 英歌舞服饰线下试穿成本高，线上展示难以感知上身效果。
- 目标：提供“上传个人照片 + 选择英歌舞服装 = 获取试装效果图”的在线体验，验证兴趣与收集反馈。

## 3. 目标用户与价值
- 普通用户/爱好者：便捷体验造型，提升互动。
- 演出队伍/社团：预览造型，辅助排练与设计。
- 商家/运营方：推广服饰与配饰，降低沟通与退货成本。

## 4. 使用场景
- 购买/租赁前预览：上传清晰半身照，挑选服饰，查看效果。
- 主题活动互动：活动页试装入口，生成后可下载/分享。
- 商家展示：上传款式生成示例效果图用于宣传。

## 5. 核心目标与指标（MVP）
- 试装请求成功率 ≥ 90%（不含外部 AI 不可用）。
- 首次全流程 ≤ 5 分钟；单次生成 ≤ 10 秒或给出进度提示。
- 结果可用性：内部评审达“可上线验证”标准。

## 6. 功能需求
### 6.1 账号与会话
- 手机/邮箱 + 密码注册、登录，基础格式校验。
- 登录返回会话（Session/JWT），用于鉴权。
- MVP 仅资料查看。

### 6.2 个人形象上传
- 上传 1 张清晰正面半身照，jpg/png，≤ 5MB。
- 前端提示拍摄/背景要求；后端校验格式与大小。
- 存储于对象存储（COS/OSS），DB 仅存 URL、类型=portrait、归属用户、时间。

### 6.3 英歌舞服装素材
- 服装图由运营/商家预置上传（类型=costume），同样走对象存储。
- MVP 可内置示例服装；商家上传/分类后续迭代。

### 6.4 AI 试装
- 前端选择人像图与服装图后发起请求。
- 后端校验登录态与图片可用性，调用外部 AI（如 Seedream）。
- MVP 同步模式；长耗时需前端展示加载并处理失败。
- 结果图存对象存储（类型=result），记录试装日志；返回结果 URL 或错误信息。

### 6.5 试装记录
- 字段：用户 ID、人像图 URL、服装图 URL、结果图 URL、状态（处理中/成功/失败）、错误信息（可选）、创建时间。
- 提供列表（倒序）与详情；MVP 暂不删除。

### 6.6 结果获取与分享
- 支持查看与下载结果图；分享链路可延后。
- 结果链接需具备签名/鉴权控制。

## 7. 非功能需求
- 性能：生成 ≤ 10 秒；列表/详情 p95 ≤ 1 秒。
- 可靠性：外部 AI/COS 不可用时友好降级；关键操作记日志。
- 安全与隐私：密码加密存储；仅登录用户可访问自身图片与记录；图片仅用于试装。
- 合规：提供隐私声明入口；后续支持图片删除/过期策略。

## 8. 数据与接口概述
- 实体
  - User：id、account、passwordHash、createdAt、role 等。
  - Image：id、userId（可空，服装图可能公共）、type（portrait/costume/result）、url、createdAt、meta。
  - TryOnRecord：id、userId、portraitImageId、costumeImageId、resultImageId、status、errorMsg、createdAt。
- 存储：业务数据存 MySQL；图片统一对象存储，系统仅保存 URL。
- API：RESTful；具体入参/出参见接口文档或 Swagger/Knife4j。

## 9. 外部依赖
- 对象存储：COS/OSS（存人像、服装、结果图）。
- AI 试装：Seedream 或同类 API（需配额与时延保障）。
- 基础设施：MySQL、日志/监控、鉴权方案（Session/JWT）。

## 10. 技术栈（当前）
- 后端：Spring Boot 3.5.x + Java 21，MyBatis-Plus 访问 MySQL，Knife4j/Swagger 暴露接口。
- 前端：Vue（独立前端仓库）。
- 依赖：Spring Security Crypto（BCrypt），MySQL 驱动；对象存储已集成腾讯 COS SDK；AI 客户端集成火山 Ark SDK（试装调用）。

## 11. 版本规划
- 当前：MVP（注册/登录 → 上传 → 选择服装 → 生成结果 → 查看记录）。
- 后续：更多服装分类与标签、批量生成/重试、结果分享与社交、商家后台（素材管理/数据看板）、与电商/活动页的深度接入。
